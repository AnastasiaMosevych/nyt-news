var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},n={},s=t.parcelRequirebcdd;null==s&&((s=function(t){if(t in e)return e[t].exports;if(t in n){var s=n[t];delete n[t];var a={id:t,exports:{}};return e[t]=a,s.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){n[t]=e},t.parcelRequirebcdd=s);const a=document.querySelector("body").dataset.name;var r;r=a,document.querySelector(`.${r}`).classList.add("active"),s("7xP6g");var i=s("7xP6g");const o={form:document.querySelector(".header__search-form"),input:document.querySelector(".search-form__input"),button:document.querySelector(".search-form__button"),newsList:document.querySelector(".list-news-card"),badRequaest:document.querySelector(".bad-request"),wether:document.querySelector(".weather"),newsBox:document.querySelector(".list-news-card")},{form:c,input:l,button:u,newsList:d,badRequaest:h,wether:g,newsBox:p}=o;const m="light-theme",y="dark-theme",b={body:document.querySelector("body"),checkboxTheme:document.querySelector("#theme-switch-toggle")};function f(){b.body.classList.toggle(y),b.body.classList.toggle(m);const t=b.body.classList.value;localStorage.setItem("Theme",t)}b.body.classList.add(m),b.checkboxTheme.addEventListener("change",f),localStorage.getItem("Theme")===y&&(b.checkboxTheme.checked="true",f());const C=[{name:"January",days:31},{name:"February",days:28},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}],w=new Date,B=w.getFullYear(),S=C[w.getMonth()],P=w.getDate();let v=w.getMonth(),L=B,_=null;const M=new Event("setdate",{bubbles:!0}),x={calendarFild:document.querySelector(".calendar__fild"),calendarInput:document.querySelector(".calendar__input"),calendarDays:document.querySelector(".calendar__days"),calendarIconUp:document.querySelector(".calendar__icon--up"),calendarIconDown:document.querySelector(".calendar__icon--down"),calendarMonthSpan:document.getElementById("month-span"),calendarYearSpan:document.getElementById("year-span"),calendarPrevButtonMonth:document.getElementById("prev-button-month"),calendarNextButtonMonth:document.getElementById("next-button-month"),calendarPrevButtonYear:document.getElementById("prev-button-year"),calendarNextButtonYear:document.getElementById("next-button-year")};function k(){x.calendarMonthSpan.textContent=S.name,x.calendarYearSpan.textContent=B,x.calendarDays.innerHTML=E(B,S.days);document.getElementById(`currentmonth-day-${P}`).classList.add("calendar__current-date")}function E(t,e){w.setFullYear(L,v,1);let n=w.getDay(),s="",a="";t%4==0&&28===e&&(e+=1),0===n&&(n+=7);for(let t=1;t<=e;t+=1)a+=`<li class="calendar__day" id="currentmonth-day-${t}">${t}</li>`;for(let t=0;t<n-1;t+=1)s+='<li class="calendar__day calendar__day--empty"></li>';return s+a}function I(t){return String(t).padStart(2,"0")}x.calendarInput.addEventListener("focus",(function(){x.calendarFild.classList.add("focus"),x.calendarInput.classList.add("focus"),x.calendarIconUp.classList.remove("calendar-is-hidden"),x.calendarIconDown.classList.add("calendar-is-hidden")})),x.calendarDays.addEventListener("click",(function(t){if("LI"!==t.target.nodeName)return;document.querySelector(".calendar__current-date")?.classList.remove("calendar__current-date"),t.target.classList.add("calendar__current-date"),x.calendarFild.classList.remove("focus"),x.calendarInput.classList.remove("focus"),x.calendarIconUp.classList.add("calendar-is-hidden"),x.calendarIconDown.classList.remove("calendar-is-hidden"),x.calendarInput.value=`${I(t.target.textContent)}-${I(v+1)}-${L}`,_=w.setFullYear(L,v,Number(t.target.textContent)),x.calendarInput.dispatchEvent(M)})),x.calendarIconUp.addEventListener("click",(function(){x.calendarFild.classList.remove("focus"),x.calendarInput.classList.remove("focus"),x.calendarIconUp.classList.add("calendar-is-hidden"),x.calendarIconDown.classList.remove("calendar-is-hidden")})),x.calendarPrevButtonMonth.addEventListener("click",(function(){v-=1,x.calendarMonthSpan.textContent=C[v].name,0===v&&(x.calendarPrevButtonMonth.disabled=!0);v<11&&(x.calendarNextButtonMonth.disabled=!1);x.calendarDays.innerHTML=E(L,C[v].days)})),x.calendarNextButtonMonth.addEventListener("click",(function(){v+=1,x.calendarMonthSpan.textContent=C[v].name,11===v&&(x.calendarNextButtonMonth.disabled=!0);v>0&&(x.calendarPrevButtonMonth.disabled=!1);x.calendarDays.innerHTML=E(L,C[v].days)})),x.calendarPrevButtonYear.addEventListener("click",(function(){L-=1,x.calendarYearSpan.textContent=L,x.calendarDays.innerHTML=E(L,C[v].days)})),x.calendarNextButtonYear.addEventListener("click",(function(){L+=1,x.calendarYearSpan.textContent=L,x.calendarDays.innerHTML=E(L,C[v].days)})),x.calendarInput.addEventListener("keyup",(function(t){const{key:e}=t;"Enter"===e&&(x.calendarFild.classList.remove("focus"),x.calendarInput.classList.remove("focus"),x.calendarIconUp.classList.add("calendar-is-hidden"),x.calendarIconDown.classList.remove("calendar-is-hidden"),x.calendarInput.dispatchEvent(M),x.calendarInput.blur(),k())})),k();var T=s("8EDGm");s("3gSZX"),s("eWdjI");i=s("7xP6g");s("eWdjI");var D=s("lQVoc");let q=(0,D.getMedia)();const N=[];(0,i.categoryOfNews)().then((t=>{N.length=0,t.forEach((t=>{N.push({section:encodeURIComponent(t.section),display_name:t.display_name})})),H=N.map((t=>`<li> <button type = "button" class ="categories_button display_button " data-section=${t.section}>${t.display_name}</button> </li>`)),Q=N.map((t=>`<li class = "inside_li"> <button type = "button" class ="other_but" data-section=${t.section}>${t.display_name}</button> </li>`)),U()}));document.querySelectorAll("button");const $=document.querySelector(".categories_ul"),O=document.querySelector(".special"),F=document.querySelector(".special_but"),W=(document.querySelectorAll(".categories_button"),document.querySelector(".icon")),R=document.querySelector(".display_buttons");F.addEventListener("click",(function(){return}));let H="",Q="";function U(){const t=(0,D.getMedia)();let e=[];2===t?e=H.slice(1,5):3===t&&(e=H.slice(1,7)),R.innerHTML="",R.insertAdjacentHTML("afterbegin",e.join(""));const n=Q.slice(7,19);O.insertAdjacentHTML("afterbegin",n.join(""))}R.addEventListener("click",(function(t){return})),$.addEventListener("click",(function(t){t.preventDefault();let e=t.target;const n=e.closest("button");n&&"BUTTON"===n.nodeName&&(e=n);if("BUTTON"!==e.nodeName)return;if("section"in e.dataset){e.dataset.section;if(e.classList.contains("categories_button")){const t=document.querySelector(".click-chang-bac");t&&t.classList.remove("click-chang-bac"),e.classList.toggle("click-chang-bac"),F.classList.contains("bek-for-other")&&(O.classList.toggle("is-hidden"),W.classList.toggle("icon-click"),F.classList.toggle("bek-for-other"))}if(e.classList.contains("other_but")){O.classList.toggle("is-hidden"),W.classList.toggle("icon-click"),F.classList.toggle("bek-for-other");const t=document.querySelector(".click-chang-bac");t&&t.classList.remove("click-chang-bac")}}e.classList.contains("special_but")&&(O.classList.toggle("is-hidden"),W.classList.toggle("icon-click"),F.classList.toggle("bek-for-other"))})),window.addEventListener("resize",(function(t){const e=(0,D.getMedia)();q!==e&&(U(),q=e)})),window.addEventListener("click",(function(t){null===t.target.closest(".categories_ul")&&F.classList.contains("bek-for-other")&&(O.classList.toggle("is-hidden"),W.classList.toggle("icon-click"),F.classList.toggle("bek-for-other"))}));const j=[4,7,8],Y=[{maxCenterButtonsCount:3,buttonWidth:28,scrollCount:1,margin:4},{maxCenterButtonsCount:5,buttonWidth:33,scrollCount:1,margin:8},{maxCenterButtonsCount:5,buttonWidth:33,scrollCount:1,margin:8}];D=s("lQVoc");class A{#t=5;#e=0;#n=7;#s=1;#a=2;#r=".paginator";#i=`${this.#r}__carousel-wrapper`;#o=`${this.#r}__carousel`;#c=null;#l=null;#u=null;#d=0;#h=0;#g=0;#p=33;#m=0;#y=8;#b=[...Y];onClick=null;constructor({itemsPerPage:t,totalItems:e,currentPage:n=1},s=[]){this.#c=document.querySelector(this.#r),this.#c?(this.#c.addEventListener("click",this.handlerOnClick.bind(this)),s&&(this.#b=[],this.#b=s,this.#f()),this.reCreate({itemsPerPage:t,totalItems:e,currentPage:n},s)):console.error(`Selector ${this.#r} not found`)}render(){if(this.#d<2)return this.#c.style.display="none","";this.#c.style.display=null;let t="";this.#c.innerHTML="";for(let t=0;t<this.#d;t+=1)this.buttons[t]=t+1;t=this.buttons.map(((t,e,n)=>`<li><button  class="paginator__button ${e+1===this.currentPage?"paginator__button--current":""}" type="button" data-page=${t} title= "Page ${t}">${this.#C(t)?"...":t}</button></li>`));const e=t[0],n=t[t.length-1],s=this.#d>2?`<li class="paginator__carousel-wrapper"><ul class="paginator__carousel">${t.slice(1,t.length-1).join("")}</ul></li>`:"";t=`<li><button  class="paginator__button paginator__button--prev" data-page="prev" type="button" title="Previous page">Prev</button></li>${e}`+s+`${n}<li><button class="paginator__button paginator__button--next" data-page="next" type="button" title="Next page">Next</button></li>`,this.#c.insertAdjacentHTML("afterbegin",t)}handlerOnClick(t){const e=t.target;"BUTTON"===e.nodeName&&"page"in e.dataset&&this.#w(e.dataset.page)}#w(t){switch(t){case"prev":if(1===this.currentPage)return;{this.#B(this.currentPage).classList.toggle("paginator__button--current"),2===this.currentPage&&this.#S("prev"),this.#P("next"),this.currentPage-=1;const t=this.#B(this.currentPage);if(t.classList.toggle("paginator__button--current"),this.#v(t))break;z(t,this.#l)||this.#L(1,this.#s)}break;case"next":if(this.currentPage===this.#d)return void this.#S("next");{this.#B(this.currentPage).classList.toggle("paginator__button--current"),this.currentPage===this.#d-1&&this.#S("next"),this.#P("prev"),this.currentPage+=1;const t=this.#B(this.currentPage);if(t.classList.toggle("paginator__button--current"),this.#v(t))break;z(t,this.#l)||this.#L(-1,this.#s)}break;default:if(this.currentPage===t)return;this.#B(this.currentPage).classList.toggle("paginator__button--current"),this.currentPage=+t;this.#B(this.currentPage).classList.toggle("paginator__button--current"),1===this.currentPage?(this.#S("prev"),this.#P("next")):this.currentPage===this.#d?(this.#S("next"),this.#P("prev")):(this.#P("next"),this.#P("prev")),1===this.currentPage&&0!==this.#a&&this.#L(1,this.#a-2),this.currentPage===this.#d&&0!==this.#a&&this.#L(-1,this.#d-this.#e-this.#a),this.#C(this.currentPage)&&(this.currentPage===this.#a?this.#L(1,2):this.#L(-1,2))}this.onClick&&this.onClick(this.currentPage)}#B(t){return this.#c.querySelector(`[data-page='${t}']`)}#_(){const t=this.#d>2?this.#e*this.#p+(this.#e-1)*this.#y:0;this.#l.style.width=`${t}px`}#L(t,e){e=t<0?this.#a+e+this.#e>this.#d?this.#d-(this.#a+e+this.#e):e:this.#a-e<2?1:e,this.#m+=t*(this.#p*e+this.#y*e),this.#u.style.left=`${this.#m}px`,this.#M(t,e)}#v(t){const e=t.dataset.page;return!(["prev","1",`${this.#d}`,"next"].indexOf(e)<0)}reCreate({itemsPerPage:t,totalItems:e,currentPage:n=1},s=[]){s&&(this.#b=[],this.#b=[...s],this.#f()),this.#m=0,this.#a=2,this.#h=t,this.#g=e,this.#d=Math.ceil(this.#g/this.#h),this.currentPage=n>this.#d?this.#d:n,this.#d>2&&(this.#e=this.#d-2>=this.#t?this.#t:this.#d-2),this.buttons=[],this.render(),this.#x()}#C(t){return 2!==t&&t!==this.#d-1&&(t===this.#a||t===this.#a+this.#e-1||void 0)}#M(t,e){const n=this.#a;let s=this.#B(n);s.innerHTML=s.dataset.page,s=this.#B(n+this.#e-1),s.innerHTML=s.dataset.page,this.#a+=e*-t,this.#C(this.#a)&&(s=this.#B(this.#a),s.innerHTML="..."),this.#C(this.#a+this.#e-1)&&(s=this.#B(this.#a+this.#e-1),s.innerHTML="...")}#S(t){const e=this.#B(t);e&&(e.disabled=!0)}#P(t){const e=this.#B(t);e&&(e.disabled=!1)}#x(){if(this.#d>2){if(this.#l=document.querySelector(this.#i),this.#u=document.querySelector(this.#o),!this.#l)return void console.error(`Selector ${this.#i} not found`);this.#_(),this.currentPage>this.buttons[this.#e]&&this.currentPage<this.#d&&this.#L(-this.#s,this.currentPage-this.buttons[this.#e]+this.#s-1)}1===this.currentPage&&this.#S("prev"),this.currentPage===this.#d&&this.#S("next")}#f(){const t=this.#b;if(t){const e=t[(0,D.getMedia)()-1];for(let t in e)switch(t){case"maxCenterButtonsCount":this.#t=e[t];break;case"buttonWidth":this.#p=e[t];break;case"scrollCount":this.#s=e[t];break;case"margin":this.#y=e[t]}}}}function z(t,e){const n=t.getBoundingClientRect(),s=e.getBoundingClientRect();return!(Math.floor(n.right)>Math.floor(s.right)||Math.floor(n.left)<Math.floor(s.left))}i=s("7xP6g"),D=s("lQVoc");class V{#k=[];#E=0;#I=1;#T="";#D="";#q="";#N=0;constructor(){}async getMostPopularNews(){const t=await(0,i.mostPopularNews2)();if("OK"===t.status){this.#k=[];const e=t.results.map((({uri:t,url:e,section:n,nytdsection:s,published_date:a,updated:r,abstract:i,title:o,media:c,multimedia:l},u)=>{const d={uri:t,url:e,sectionname:n,section:s,newsdate:(0,D.formatDate)(r||a),snippet:i,title:o,isfavorite:!1,isread:!1};return null===c||0===c.length?d.image="":d.image=c[0]["media-metadata"][2].url,d}));this.#k.push(...e),this.#E=t.num_results}else console.error(`Failed to get popular news (статус-${t.status})`);this.#I=1}async getNewsByCategory(t,e,n){try{const s=await(0,i.getArticleByCategory2)(t,e,n);if("OK"===s.status){const n=s.results.map((({uri:e,url:n,section:s,published_date:a,updated_date:r,abstract:i,title:o,multimedia:c},l)=>{const u={uri:e,url:n,sectionname:s,section:t,newsdate:(0,D.formatDate)(a||r),snippet:i,title:o,isfavorite:!1,isread:!1};if(null===c||0===c.length)u.image="";else{["mediumThreeByTwo440","mediumThreeByTwo210","Normal"].forEach((t=>{let e=c.find((e=>e.format===t));void 0===u.image&&void 0!==e&&(u.image=e.url)}))}return u}));0===e&&(this.#k=[]),this.#k.push(...n),this.#E=this.#k.length,this.#I=2,this.#T=t}}catch(s){console.error(`Failed to get news by category ${t} offset=${e} limit=${n} with ${s}`)}}async getNewsBySearch(t,e,n){try{const s=await(0,i.getSearchArticles2)(t,e,n);if("OK"===s.status){const n=s.results.map((({uri:t,web_url:e,section_name:n,pub_date:s,abstract:a,headline:r,multimedia:i},o)=>{const c={uri:t,url:e,sectionname:n,section:n,newsdate:(0,D.formatDate)(s),snippet:a,title:r.main??"",isfavorite:!1,isread:!1};return null===i||0===i.length?c.image="":c.image="https://www.nytimes.com/"+i[0].url,c}));0===e&&(this.#k=[]),this.#k.push(...n),this.#E=s.num_results,this.#I=3,this.#q=t,this.#T="",this.#N=e,this.#D=""}}catch(s){console.error(`Failed to get news by query ${t} page=${e} date=${n} with ${s}`)}}async getData(t,e){let n=[];if(t+e<=this.#k.length||t+e>this.#k.length&&this.#k.length===this.getTotalNews()){n=(""!==this.#D?this.#k.filter((({newsdate:t})=>t===this.#D)):this.#k).slice(t,t+e)}else if(2===this.#I){const s=this.getDataLength(),a=(0,D.calculateLimit)(t,s);await this.getNewsByCategory(this.#T,s,a),n=this.#k.slice(t,t+e)}else 3===this.#I&&(await this.getNewsBySearch(this.#q,this.#N+1,this.#D),n=this.#k.slice(t,t+e));return n}getTotalNews(){let t=0;switch(this.#I){case 1:case 2:t=""!==this.#D?this.#k.filter((({newsdate:t})=>t===this.#D)).length:this.#k.length;break;case 3:t=""!==this.#D?this.#k.filter((({newsdate:t})=>t===this.#D)).length:10}return t}getDataLength(){return this.#k.length}setFilter(t){this.#D=t}}var J=s("eWdjI"),K=(D=s("lQVoc"),s("3gSZX"));class X{#$=null;#O=[1,2,3];constructor(){this.#$=document.querySelector(".list-news-card")}async showPage(t,e,n){const s=(0,D.getPageStartIndex)(t,e),a=await n.getData(s,e);await this.render(a)}async render(t){try{let e=t.map(((t,e)=>(0,J.createMarkup2)(t)));e=this.#F(e);const n=e.join("");this.#W(n),(0,K.geolocateUpdate)()}catch(t){console.error(t)}}#W(t){null!==this.#$&&(this.#$.innerHTML=t)}#F(t){const e=this.#O[(0,D.getMedia)()-1]-1;return t.splice(e,0,'<li class="list-news-card__item weather"></li>'),t}}class Z{#R;constructor(){this.#R=document.createElement("div"),this.#R.classList.add("spinner-wrap"),this.#R.classList.add("spinner-invisible"),this.#R.insertAdjacentHTML("afterbegin",'<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>'),document.body.append(this.#R)}showSpinner(){this.#R.classList.remove("spinner-invisible")}hideSpinner(){this.#R.classList.add("spinner-invisible")}}D=s("lQVoc");new class{#H=null;#Q="";#U=null;#j="";#Y=null;#A=null;#z=null;#V="";#J=null;#R=null;#K=(0,D.getMedia)();#X=1;constructor({categorySelector:t,searchSelector:e,calendarSelector:n}){this.#Z({categorySelector:t,searchSelector:e,calendarSelector:n}),this.#H=new V,this.#z=new X,this.#R=new Z,this.#G()}#Z({categorySelector:t,searchSelector:e,calendarSelector:n}){this.#Q=t,this.#U=document.querySelector(t),this.#U?(this.#U.addEventListener("click",this.#tt.bind(this)),this.#j=e,this.#Y=document.querySelector(e),this.#Y?(this.#Y.addEventListener("submit",this.#et.bind(this)),this.#V=n,this.#J=document.querySelector(n),this.#J?this.#J.addEventListener("setdate",this.#nt.bind(this)):console.error(`Calendar element ${n} not found`)):console.error(`Search element ${e} not found`)):console.error(`Category element ${t} not found`)}async#tt(t){t.preventDefault();const e=j[(0,D.getMedia)()-1];this.#X=1;let n=t.target;const s=n.closest("button");if(s&&"BUTTON"===s.nodeName&&(n=s),"BUTTON"===n.nodeName&&"section"in n.dataset){const t=n.dataset.section;this.#R.showSpinner(),await this.#H.getNewsByCategory(t,0,500),this.#A.reCreate({itemsPerPage:e,totalItems:this.#H.getDataLength(),currentPage:this.#X},Y),await this.#z.showPage(1,e,this.#H),this.#R.hideSpinner()}}async#et(t){t.preventDefault();const e=j[(0,D.getMedia)()-1];this.#X=1;const n=t.target.elements[0].value;""!==n&&(this.#R.showSpinner(),await this.#H.getNewsBySearch(n,0,""),this.#A.reCreate({itemsPerPage:e,totalItems:this.#H.getTotalNews(),currentPage:this.#X},Y),await this.#z.showPage(1,e,this.#H),this.#R.hideSpinner())}async#nt(t){const e=t.target.value,n=j[(0,D.getMedia)()-1];this.#X=1,this.#H.setFilter(e),this.#A.reCreate({itemsPerPage:n,totalItems:this.#H.getTotalNews(),currentPage:this.#X},Y),await this.#z.showPage(1,n,this.#H)}async#st(t){const e=j[(0,D.getMedia)()-1];this.#X=t,this.#R.showSpinner(),await this.#z.showPage(t,e,this.#H),this.#R.hideSpinner(),window.scrollTo({top:0,left:0,behavior:"smooth"})}async#G(){const t=j[(0,D.getMedia)()-1];this.#R.showSpinner(),await this.#H.getMostPopularNews(),window.addEventListener("resize",this.#at.bind(this)),this.#A=new A({itemsPerPage:t,totalItems:this.#H.getTotalNews(),currentPage:1},Y),this.#A.onClick=this.#st.bind(this),await this.#z.showPage(1,t,this.#H),this.#R.hideSpinner()}async#at(){const t=(0,D.getMedia)();if(this.#K!==t){let e=j[this.#K-1];const n=(0,D.getPageStartIndex)(this.#X,e);e=j[t-1];const s=Math.floor(n/e)+1;await this.#z.showPage(s,e,this.#H),this.#A.reCreate({currentPage:s,itemsPerPage:e,totalItems:this.#H.getTotalNews()},Y),this.#K=t}}}({categorySelector:".categories_ul",searchSelector:".header__search-form",calendarSelector:".calendar__input"});new(0,T.default)("team-9-project");
//# sourceMappingURL=index.32be99d3.js.map
